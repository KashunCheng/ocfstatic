"use strict";(self.webpackChunkdocusaurus=self.webpackChunkdocusaurus||[]).push([[3944],{3905:(e,t,a)=>{a.d(t,{Zo:()=>u,kt:()=>m});var n=a(7294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function i(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function s(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},o=Object.keys(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var p=n.createContext({}),l=function(e){var t=n.useContext(p),a=t;return e&&(a="function"==typeof e?e(t):i(i({},t),e)),a},u=function(e){var t=l(e.components);return n.createElement(p.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},d=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,o=e.originalType,p=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),d=l(a),m=r,h=d["".concat(p,".").concat(m)]||d[m]||c[m]||o;return a?n.createElement(h,i(i({ref:t},u),{},{components:a})):n.createElement(h,i({ref:t},u))}));function m(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=a.length,i=new Array(o);i[0]=d;var s={};for(var p in t)hasOwnProperty.call(t,p)&&(s[p]=t[p]);s.originalType=e,s.mdxType="string"==typeof e?e:r,i[1]=s;for(var l=2;l<o;l++)i[l]=a[l];return n.createElement.apply(null,i)}return n.createElement.apply(null,a)}d.displayName="MDXCreateElement"},2808:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>p,contentTitle:()=>i,default:()=>c,frontMatter:()=>o,metadata:()=>s,toc:()=>l});var n=a(7462),r=(a(7294),a(3905));const o={title:"Web application hosting (group)"},i=void 0,s={unversionedId:"services/webapps/webapps",id:"services/webapps/webapps",title:"Web application hosting (group)",description:"Note: This document only applies to student groups with virtual hosts who",source:"@site/docs/services/webapps/webapps.md",sourceDirName:"services/webapps",slug:"/services/webapps/",permalink:"/docs/services/webapps/",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/services/webapps/webapps.md",tags:[],version:"current",frontMatter:{title:"Web application hosting (group)"},sidebar:"tutorialSidebar",previous:{title:"WordPress",permalink:"/docs/services/web/wordpress"},next:{title:"Node.js",permalink:"/docs/services/webapps/nodejs"}},p={},l=[{value:"Introduction",id:"introduction",level:2},{value:"App hosting eligibility",id:"app-hosting-eligibility",level:2},{value:"Requesting app hosting",id:"requesting-app-hosting",level:2},{value:"Requirements for virtually-hosted apps",id:"requirements-for-virtually-hosted-apps",level:2},{value:"Technical documentation",id:"technical-documentation",level:2},{value:"Connecting to the application server",id:"connecting-to-the-application-server",level:3},{value:"Routing traffic to your app",id:"routing-traffic-to-your-app",level:3},{value:"Supervising and starting your app {supervise}",id:"supervising-and-starting-your-app-supervise",level:3},{value:"Frequently asked questions",id:"frequently-asked-questions",level:2},{value:"Can you install a package on the app server?",id:"can-you-install-a-package-on-the-app-server",level:3},{value:"This package is 7 years old. Can you update it?",id:"this-package-is-7-years-old-can-you-update-it",level:3},{value:"How do I get a database for my application?",id:"how-do-i-get-a-database-for-my-application",level:3},{value:"I&#39;m running my app on port 3000 but I can&#39;t access it.",id:"im-running-my-app-on-port-3000-but-i-cant-access-it",level:3}],u={toc:l};function c(e){let{components:t,...a}=e;return(0,r.kt)("wrapper",(0,n.Z)({},u,a,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Note: This document only applies to student groups with virtual hosts who\nhave applied for apphosting. For normal user accounts or for groups without\napphosting, you'll want to host with FastCGI instead.")),(0,r.kt)("h2",{id:"introduction"},"Introduction"),(0,r.kt)("p",null,"All accounts include our ",(0,r.kt)("a",{parentName:"p",href:"/docs/services/web"},"standard web hosting"),", which is\nsuitable for static content, PHP (WordPress, Joomla, etc.), and CGI/FastCGI.\nFor student groups wishing to host more advanced web apps with the OCF (Django,\nFlask, Rails, Node.js, etc.), we offer a separate hosting platform which\nprovides more flexibility."),(0,r.kt)("h2",{id:"app-hosting-eligibility"},"App hosting eligibility"),(0,r.kt)("p",null,"App hosting is ",(0,r.kt)("em",{parentName:"p"},"only available for student groups with ",(0,r.kt)("a",{parentName:"em",href:"/docs/services/vhost"},"virtually-hosting domain names"))," (either group.berkeley.edu, or your own\nseparately-purchased domain name). If you don't already have a virtual host and\nwant to use app hosting, see below for instructions; please don't fill out a\nvirtual host request form."),(0,r.kt)("h2",{id:"requesting-app-hosting"},"Requesting app hosting"),(0,r.kt)("p",null,"To request app hosting, you need to first ",(0,r.kt)("a",{parentName:"p",href:"/docs/membership"},"create an OCF group account"),". Once you have an account, email ",(0,r.kt)("inlineCode",{parentName:"p"},"hostmaster@ocf.berkeley.edu"),"\nwith at least the following information:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Group's account name"),(0,r.kt)("li",{parentName:"ul"},"Group's current website, if any (even if not hosted by OCF)"),(0,r.kt)("li",{parentName:"ul"},"Desired domain name for the app (either group.berkeley.edu, or your own\ndomain)"),(0,r.kt)("li",{parentName:"ul"},"The technologies/languages your site is built on")),(0,r.kt)("h2",{id:"requirements-for-virtually-hosted-apps"},"Requirements for virtually-hosted apps"),(0,r.kt)("p",null,"All ",(0,r.kt)("a",{parentName:"p",href:"/docs/services/vhost"},"normal requirements for virtual hosts"),' apply. In\nparticular, be sure you are in compliance with the university student group\ndisclaimer policy, and that your website features a "Hosted by OCF" banner.'),(0,r.kt)("h2",{id:"technical-documentation"},"Technical documentation"),(0,r.kt)("p",null,"You can host basically any kind of web application that can bind to a socket.\nWe provide suggested deployment instructions for some popular web applications\nbelow, but if you know what you're doing, you needn't follow them."),(0,r.kt)("h3",{id:"connecting-to-the-application-server"},"Connecting to the application server"),(0,r.kt)("p",null,"We provide a separate server (currently named ",(0,r.kt)("inlineCode",{parentName:"p"},"vampires"),"), for hosting\napplications. ",(0,r.kt)("strong",{parentName:"p"},"You should connect to this server"),", not to the public login\nserver."),(0,r.kt)("p",null,"You connect to this server via SSH using your normal OCF account name and\npassword."),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Host:")," apphost.ocf.berkeley.edu"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Port:")," 22")),(0,r.kt)("p",null,"If your login is refused (but you ",(0,r.kt)("em",{parentName:"p"},"can")," log in to ",(0,r.kt)("inlineCode",{parentName:"p"},"ssh.ocf.berkeley.edu"),"), your\naccount probably isn't configured yet. Contact us (see above) to request app\nhosting on your account."),(0,r.kt)("h3",{id:"routing-traffic-to-your-app"},"Routing traffic to your app"),(0,r.kt)("p",null,"Our application server uses a reverse proxy to route traffic to UNIX sockets\nlocated at ",(0,r.kt)("inlineCode",{parentName:"p"},"/srv/apps/username/username.sock"),". Your application should bind to\nthat socket; basically any server can be configured to bind to a UNIX socket\ninstead of a port, so do that."),(0,r.kt)("p",null,"We provide some example setups below."),(0,r.kt)("h3",{id:"supervising-and-starting-your-app-supervise"},"Supervising and starting your app {supervise}"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Make sure you do these steps on the application server.")," If you start your\napp on tsunami, the public login server, it won't work."),(0,r.kt)("p",null,"We may restart the application server as part of regular maintenance, and\nyou'll want your app to start again when we do. You'll also want your app to\nautomatically restart if it crashes."),(0,r.kt)("p",null,"We highly recommend to use systemd to supervise your app. Our recommended setup\nis:"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Create a directory for your app ",(0,r.kt)("inlineCode",{parentName:"p"},"~/myapp"),".")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Place a startup script at ",(0,r.kt)("inlineCode",{parentName:"p"},"~/myapp/run"),". Your script should end by ",(0,r.kt)("inlineCode",{parentName:"p"},"exec"),"ing\nthe server process. If you followed one of the guides for ",(0,r.kt)("a",{parentName:"p",href:"/docs/services/webapps/nodejs"},"Node.js"),", ",(0,r.kt)("a",{parentName:"p",href:"/docs/services/webapps/rails"},"Rails"),", or\n",(0,r.kt)("a",{parentName:"p",href:"/docs/services/webapps/python"},"Django"),", you've already created this file, so\ncan move on to the next step."),(0,r.kt)("p",{parentName:"li"},"Otherwise, an example would be:"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre"},"#!/bin/sh -e\nexec ~/myapp/run-server\n")),(0,r.kt)("p",{parentName:"li"},"Your server should run in the ",(0,r.kt)("em",{parentName:"p"},"foreground")," (it should not daemonize), and\nthe ",(0,r.kt)("inlineCode",{parentName:"p"},"run")," script should end with an ",(0,r.kt)("inlineCode",{parentName:"p"},"exec")," line so that signals are sent to\nthe server (and not to the shell that started it)."),(0,r.kt)("p",{parentName:"li"},"Once you've written the script, make it executable (",(0,r.kt)("inlineCode",{parentName:"p"},"chmod +x ~/myapp/run"),").\nTest it by executing it in your terminal before moving on; it will be easier\nto debug problems.")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Write a systemd service file so your app will be supervised on startup. Save\nthe following to the file ",(0,r.kt)("inlineCode",{parentName:"p"},"~/.config/systemd/user/myapp.service"),":"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre"},"[Unit]\nDescription={YOUR GROUP NAME} Webapp\nConditionHost=vampires\n\n[Install]\nWantedBy=default.target\n\n[Service]\nExecStart=/home/{U}/{UU}/{USERNAME}/myapp/run\nRestart=always\n")),(0,r.kt)("p",{parentName:"li"},"Make sure to replace ",(0,r.kt)("inlineCode",{parentName:"p"},"{YOUR GROUP NAME}")," above with your actual group name,\nand also replace ",(0,r.kt)("inlineCode",{parentName:"p"},"{U}")," with the first letter of your username, ",(0,r.kt)("inlineCode",{parentName:"p"},"{UU}")," with\nthe first two letters of your username, and ",(0,r.kt)("inlineCode",{parentName:"p"},"{USERNAME}")," with your username.")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Tell systemd to start your app on startup, by running ",(0,r.kt)("inlineCode",{parentName:"p"},"systemctl --user enable myapp"),".")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"You'll need to start your app manually once (on future reboots, it will be\nstarted for you). To do that, run ",(0,r.kt)("inlineCode",{parentName:"p"},"systemctl --user start myapp"),"."))),(0,r.kt)("p",null,"To control your app, you can use the ",(0,r.kt)("inlineCode",{parentName:"p"},"systemctl")," tool. See ",(0,r.kt)("inlineCode",{parentName:"p"},"man systemctl")," for\nfull details. In summary,"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Restart an app.")," ",(0,r.kt)("inlineCode",{parentName:"li"},"systemctl --user restart myapp")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Bring an app offline.")," ",(0,r.kt)("inlineCode",{parentName:"li"},"systemctl --user stop myapp")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Bring an app back online.")," ",(0,r.kt)("inlineCode",{parentName:"li"},"systemctl --user start myapp")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Check the status of an app.")," ",(0,r.kt)("inlineCode",{parentName:"li"},"systemctl --user status myapp"))),(0,r.kt)("p",null,"Your app's standard output and error streams are sent to systemd's journal (by\ndefault). You can view them using ",(0,r.kt)("inlineCode",{parentName:"p"},"journalctl --user -n"),". See ",(0,r.kt)("inlineCode",{parentName:"p"},"man journalctl"),"\nfor more options."),(0,r.kt)("h2",{id:"frequently-asked-questions"},"Frequently asked questions"),(0,r.kt)("h3",{id:"can-you-install-a-package-on-the-app-server"},"Can you install a package on the app server?"),(0,r.kt)("p",null,"Probably. ",(0,r.kt)("a",{parentName:"p",href:"/docs/contact"},"Send us an email"),", and be sure to provide the name of\nthe ",(0,r.kt)("a",{parentName:"p",href:"https://www.debian.org/distrib/packages#search_packages"},"Debian package")," you want us to install. Keep in mind we'll probably\nbe installing the stable version of the package, so it might be old."),(0,r.kt)("p",null,"You might prefer to install the package locally. See below."),(0,r.kt)("h3",{id:"this-package-is-7-years-old-can-you-update-it"},"This package is 7 years old. Can you update it?"),(0,r.kt)("p",null,"Probably not. Our servers run Debian stable, so it's expected that system\npackages aren't current (indeed, they're often a few years old). We almost\nnever make exceptions or install backported packages."),(0,r.kt)("p",null,"For developing and deploying your app, you should almost certainly be using\nyour platform's version manager (rvm, virtualenv, nvm, gvm, etc.). This will\nallow you to run the exact versions you want, and install any necessary\ndependencies, all without coordinating with us (or forcing the rest of our\nusers to switch versions)."),(0,r.kt)("p",null,"The pages above provide instructions on doing this with popular programming\nlanguages."),(0,r.kt)("h3",{id:"how-do-i-get-a-database-for-my-application"},"How do I get a database for my application?"),(0,r.kt)("p",null,"A ",(0,r.kt)("a",{parentName:"p",href:"/docs/services/mysql"},"MySQL database")," is included with your OCF account. You\nshould probably just use that. We're ",(0,r.kt)("em",{parentName:"p"},"not")," going to set up a different database\nfor you (you could install one in your home directory if you ",(0,r.kt)("em",{parentName:"p"},"really")," want to)."),(0,r.kt)("h3",{id:"im-running-my-app-on-port-3000-but-i-cant-access-it"},"I'm running my app on port 3000 but I can't access it."),(0,r.kt)("p",null,"The app server is behind a firewall; you won't be able to access most ports\nfrom outside of the OCF. You could come work from ",(0,r.kt)("a",{parentName:"p",href:"/docs/services/lab"},"the lab"),",\nor forward the port over SSH from elsewhere."))}c.isMDXComponent=!0}}]);