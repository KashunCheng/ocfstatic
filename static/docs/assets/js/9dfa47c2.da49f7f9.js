"use strict";(self.webpackChunkdocusaurus=self.webpackChunkdocusaurus||[]).push([[6990],{3905:(e,t,n)=>{n.d(t,{Zo:()=>u,kt:()=>d});var r=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function p(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var i=r.createContext({}),l=function(e){var t=r.useContext(i),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},u=function(e){var t=l(e.components);return r.createElement(i.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},m=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,o=e.originalType,i=e.parentName,u=p(e,["components","mdxType","originalType","parentName"]),m=l(n),d=a,y=m["".concat(i,".").concat(d)]||m[d]||c[d]||o;return n?r.createElement(y,s(s({ref:t},u),{},{components:n})):r.createElement(y,s({ref:t},u))}));function d(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=n.length,s=new Array(o);s[0]=m;var p={};for(var i in t)hasOwnProperty.call(t,i)&&(p[i]=t[i]);p.originalType=e,p.mdxType="string"==typeof e?e:a,s[1]=p;for(var l=2;l<o;l++)s[l]=n[l];return r.createElement.apply(null,s)}return r.createElement.apply(null,n)}m.displayName="MDXCreateElement"},4372:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>i,contentTitle:()=>s,default:()=>c,frontMatter:()=>o,metadata:()=>p,toc:()=>l});var r=n(7462),a=(n(7294),n(3905));const o={title:"Node.js"},s=void 0,p={unversionedId:"services/webapps/nodejs",id:"services/webapps/nodejs",title:"Node.js",description:"Note: This document only applies to student groups with virtual hosts who",source:"@site/docs/services/webapps/nodejs.md",sourceDirName:"services/webapps",slug:"/services/webapps/nodejs",permalink:"/docs/services/webapps/nodejs",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/services/webapps/nodejs.md",tags:[],version:"current",frontMatter:{title:"Node.js"},sidebar:"tutorialSidebar",previous:{title:"Web application hosting (group)",permalink:"/docs/services/webapps/"},next:{title:"Python (Django, Flask, etc.)",permalink:"/docs/services/webapps/python"}},i={},l=[{value:"Setting up nvm",id:"setting-up-nvm",level:2},{value:"Preparing your app to be supervised",id:"preparing-your-app-to-be-supervised",level:2},{value:"Supervise your app with systemd",id:"supervise-your-app-with-systemd",level:2},{value:"Suggestions/improvements?",id:"suggestionsimprovements",level:2}],u={toc:l};function c(e){let{components:t,...n}=e;return(0,a.kt)("wrapper",(0,r.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"Note: This document only applies to student groups with virtual hosts who\nhave applied for apphosting. For normal user accounts or for groups without\napphosting, you'll want to host with FastCGI instead.")),(0,a.kt)("p",null,"You will want to deploy your application using nvm so that you can easily\ninstall and manage dependencies and versions."),(0,a.kt)("h2",{id:"setting-up-nvm"},"Setting up nvm"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"Create a directory for your app to live in:"),(0,a.kt)("p",{parentName:"li"},"mkdir -p ~/myapp\ncd ~/myapp")),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"Install nvm in your home directory. Note that ",(0,a.kt)("inlineCode",{parentName:"p"},"nvm")," is terrible and will\nmodify your shell config files without asking. But maybe that's what you\nwant?"),(0,a.kt)("p",{parentName:"li"},"Go find the latest version from ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/creationix/nvm"},"the NVM GitHub"),", and copy the\nnasty one-liner straight into your shell to install it. At the time of\nwriting, it looks like this:"),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre"},"curl -o- https://raw.githubusercontent.com/creationix/nvm/v0.33.0/install.sh | bash\n")),(0,a.kt)("p",{parentName:"li"},"Go ahead and run it, and close/re-open your terminal as it suggests.")),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"Install whatever version of Node.js you want."),(0,a.kt)("p",{parentName:"li"},"nvm install 6\nnvm alias default 6")),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"Copy your code to ",(0,a.kt)("inlineCode",{parentName:"p"},"~/myapp/src")," or similar, and install any dependencies\nusing ",(0,a.kt)("inlineCode",{parentName:"p"},"npm"),"."))),(0,a.kt)("h2",{id:"preparing-your-app-to-be-supervised"},"Preparing your app to be supervised"),(0,a.kt)("p",null,"Create a file at ",(0,a.kt)("inlineCode",{parentName:"p"},"~/myapp/run")," with content like:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},'#!/bin/bash -e\nUSER="$(whoami)"\n[ -e "/srv/apps/$USER/$USER.sock" ] && rm "/srv/apps/$USER/$USER.sock"\numask 0\n\n. ~/.nvm/nvm.sh\nNODE_ENV=production PORT="/srv/apps/$USER/$USER.sock" \\\n    exec ~/myapp/src/bin/www\n')),(0,a.kt)("p",null,"Replace ",(0,a.kt)("inlineCode",{parentName:"p"},"~/myapp/src/bin/www")," with the path to your app, then make ",(0,a.kt)("inlineCode",{parentName:"p"},"run"),"\nexecutable:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"chmod +x ~/myapp/run\n")),(0,a.kt)("p",null,"Test executing the run script. You should be able to access your website while\nrunning it (or see any errors in your terminal)."),(0,a.kt)("h2",{id:"supervise-your-app-with-systemd"},"Supervise your app with systemd"),(0,a.kt)("p",null,"Cool, your app works. ",(0,a.kt)("a",{parentName:"p",href:"/docs/services/webapps#supervise"},"Set up systemd")," to\nsupervise your app (so that it starts and restarts automatically)."),(0,a.kt)("h2",{id:"suggestionsimprovements"},"Suggestions/improvements?"),(0,a.kt)("p",null,"If you have a better way to host Node.js-based apps on the app server (or a\nsuggestion for how we could improve this documentation), ",(0,a.kt)("a",{parentName:"p",href:"/docs/contact"},"send us an email"),"!"))}c.isMDXComponent=!0}}]);